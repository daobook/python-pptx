
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />


    <title>Working with charts &#8212; python-pptx 0.6.21 文档</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../../_static/searchtools.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Working with tables" href="table.html" />
    <link rel="prev" title="文本" href="text.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="table.html" title="Working with tables"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="text.html" title="文本"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Working with charts</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="working-with-charts">
<h1>Working with charts<a class="headerlink" href="#working-with-charts" title="永久链接至标题">¶</a></h1>
<p><cite>python-pptx</cite> supports adding charts and modifying existing ones. Most chart types
other than 3D types are supported.</p>
<section id="adding-a-chart">
<h2>Adding a chart<a class="headerlink" href="#adding-a-chart" title="永久链接至标题">¶</a></h2>
<p>The following code adds a single-series column chart in a new presentation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pptx</span> <span class="kn">import</span> <span class="n">Presentation</span>
<span class="kn">from</span> <span class="nn">pptx.chart.data</span> <span class="kn">import</span> <span class="n">CategoryChartData</span>
<span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="kn">import</span> <span class="n">XL_CHART_TYPE</span>
<span class="kn">from</span> <span class="nn">pptx.util</span> <span class="kn">import</span> <span class="n">Inches</span>

<span class="c1"># create presentation with 1 slide ------</span>
<span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">()</span>
<span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># define chart data ---------------------</span>
<span class="n">chart_data</span> <span class="o">=</span> <span class="n">CategoryChartData</span><span class="p">()</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="s1">&#39;West&#39;</span><span class="p">,</span> <span class="s1">&#39;Midwest&#39;</span><span class="p">]</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Series 1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">19.2</span><span class="p">,</span> <span class="mf">21.4</span><span class="p">,</span> <span class="mf">16.7</span><span class="p">))</span>

<span class="c1"># add chart to slide --------------------</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span>
<span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">COLUMN_CLUSTERED</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span>

<span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;chart-01.pptx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/chart-01.png" src="../_images/chart-01.png" />
</section>
<section id="customizing-things-a-bit">
<h2>Customizing things a bit<a class="headerlink" href="#customizing-things-a-bit" title="永久链接至标题">¶</a></h2>
<p>The remaining code will leave out code we’ve already seen and only show
imports, for example, when they’re used for the first time, just to keep the
focus on the new bits. Let’s create a multi-series chart to use for these
examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="s1">&#39;West&#39;</span><span class="p">,</span> <span class="s1">&#39;Midwest&#39;</span><span class="p">]</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Q1 Sales&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">19.2</span><span class="p">,</span> <span class="mf">21.4</span><span class="p">,</span> <span class="mf">16.7</span><span class="p">))</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Q2 Sales&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">22.3</span><span class="p">,</span> <span class="mf">28.6</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">))</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Q3 Sales&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">20.4</span><span class="p">,</span> <span class="mf">26.3</span><span class="p">,</span> <span class="mf">14.2</span><span class="p">))</span>

<span class="n">graphic_frame</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">COLUMN_CLUSTERED</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">graphic_frame</span><span class="o">.</span><span class="n">chart</span>
</pre></div>
</div>
<img alt="../_images/chart-02.png" src="../_images/chart-02.png" />
<p>Notice that we captured the shape reference returned by the
<a class="reference internal" href="../api/shapes.html#pptx.shapes.shapetree.SlideShapes.add_chart" title="pptx.shapes.shapetree.SlideShapes.add_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_chart()</span></code></a> call as <code class="docutils literal notranslate"><span class="pre">graphic_frame</span></code> and then extracted
the chart object from the graphic frame using its
<a class="reference internal" href="../api/shapes.html#pptx.shapes.graphfrm.GraphicFrame.chart" title="pptx.shapes.graphfrm.GraphicFrame.chart"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chart</span></code></a> property. We’ll need the chart reference to get
to the properties we’ll need in the next steps. The
<a class="reference internal" href="../api/shapes.html#pptx.shapes.shapetree.SlideShapes.add_chart" title="pptx.shapes.shapetree.SlideShapes.add_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_chart()</span></code></a> method doesn’t directly return the chart
object. That’s because a chart is not itself a shape. Rather it’s a graphical
(DrawingML) object <em>contained</em> in the graphic frame shape. Tables work this
way too, also being contained in a graphic frame shape.</p>
</section>
<section id="xy-and-bubble-charts">
<h2>XY and Bubble charts<a class="headerlink" href="#xy-and-bubble-charts" title="永久链接至标题">¶</a></h2>
<p>The charts so far use a <em>discrete</em> set of values for the independent variable
(the X axis, roughly speaking). These are perfect when your values fall into
a well-defined set of categories. However, there are many cases, particularly
in science and engineering, where the independent variable is a continuous
value, such as temperature or frequency. These are supported in PowerPoint by
XY (aka. scatter) charts. A bubble chart is essentially an XY chart where the
marker size is used to reflect an additional value, effectively adding
a third dimension to the chart.</p>
<p>Because the independent variable is continuous, in general, the series do not
all share the same X values. This requires a somewhat different data
structure and that is provided for by distinct <a class="reference internal" href="../api/chart-data.html#pptx.chart.data.XyChartData" title="pptx.chart.data.XyChartData"><code class="xref py py-class docutils literal notranslate"><span class="pre">XyChartData</span></code></a> and
<a class="reference internal" href="../api/chart-data.html#pptx.chart.data.BubbleChartData" title="pptx.chart.data.BubbleChartData"><code class="xref py py-class docutils literal notranslate"><span class="pre">BubbleChartData</span></code></a> objects used to specify the data behind charts of these
types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">XyChartData</span><span class="p">()</span>

<span class="n">series_1</span> <span class="o">=</span> <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Model 1&#39;</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">series_2</span> <span class="o">=</span> <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Model 2&#39;</span><span class="p">)</span>
<span class="n">series_2</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">)</span>
<span class="n">series_2</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">2.7</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">)</span>
<span class="n">series_2</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">XY_SCATTER</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span><span class="o">.</span><span class="n">chart</span>
</pre></div>
</div>
<img alt="../_images/chart-08.png" src="../_images/chart-08.png" />
<p>Creation of a bubble chart is very similar, having an additional value for each data point that specifies the bubble size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">BubbleChartData</span><span class="p">()</span>

<span class="n">series_1</span> <span class="o">=</span> <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Series 1&#39;</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">series_1</span><span class="o">.</span><span class="n">add_data_point</span><span class="p">(</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BUBBLE</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span><span class="o">.</span><span class="n">chart</span>
</pre></div>
</div>
<img alt="../_images/chart-09.png" src="../_images/chart-09.png" />
</section>
<section id="axes">
<h2>Axes<a class="headerlink" href="#axes" title="永久链接至标题">¶</a></h2>
<p>Let’s change up the category and value axes a bit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="kn">import</span> <span class="n">XL_TICK_MARK</span>
<span class="kn">from</span> <span class="nn">pptx.util</span> <span class="kn">import</span> <span class="n">Pt</span>

<span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
<span class="n">category_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">category_axis</span><span class="o">.</span><span class="n">minor_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>
<span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

<span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
<span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">value_axis</span><span class="o">.</span><span class="n">minor_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>
<span class="n">value_axis</span><span class="o">.</span><span class="n">has_minor_gridlines</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
<span class="n">tick_labels</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&quot;%&quot;&#39;</span>
<span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/chart-03.png" src="../_images/chart-03.png" />
<p>Okay, that was probably going a bit too far. But it gives us an idea of the
kinds of things we can do with the value and category axes. Let’s undo this
part and go back to the version we had before.</p>
</section>
<section id="data-labels">
<h2>Data Labels<a class="headerlink" href="#data-labels" title="永久链接至标题">¶</a></h2>
<p>Let’s add some data labels so we can see exactly what the value for each bar
is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pptx.dml.color</span> <span class="kn">import</span> <span class="n">RGBColor</span>
<span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="kn">import</span> <span class="n">XL_LABEL_POSITION</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plot</span><span class="o">.</span><span class="n">has_data_labels</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">data_labels</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">data_labels</span>

<span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">)</span>
<span class="n">data_labels</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LABEL_POSITION</span><span class="o">.</span><span class="n">INSIDE_END</span>
</pre></div>
</div>
<img alt="../_images/chart-04.png" src="../_images/chart-04.png" />
<p>Here we needed to access a Plot object to gain access to the data labels.
A plot is like a sub-chart, containing one or more series and drawn as
a particular chart type, like column or line. This distinction is needed for
charts that combine more than one type, like a line chart appearing on top of
a column chart. A chart like this would have two plot objects, one for the
series appearing as columns and the other for the lines. Most charts only
have a single plot and <cite>python-pptx</cite> doesn’t yet support creating multi-plot charts,
but you can access multiple plots on a chart that already has them.</p>
<p>In the Microsoft API, the name <em>ChartGroup</em> is used for this object. I found
that term confusing for a long time while I was learning about MS Office
charts so I chose the name Plot for that object in <cite>python-pptx</cite>.</p>
</section>
<section id="legend">
<h2>Legend<a class="headerlink" href="#legend" title="永久链接至标题">¶</a></h2>
<p>A legend is often useful to have on a chart, to give a name to each series
and help a reader tell which one is which:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="kn">import</span> <span class="n">XL_LEGEND_POSITION</span>

<span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">RIGHT</span>
<span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<img alt="../_images/chart-05.png" src="../_images/chart-05.png" />
<p>Nice! Okay, let’s try some other chart types.</p>
</section>
<section id="line-chart">
<h2>Line Chart<a class="headerlink" href="#line-chart" title="永久链接至标题">¶</a></h2>
<p>A line chart is added pretty much the same way as a bar or column chart, the
main difference being the chart type provided in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_chart()</span></code> call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Q1 Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2 Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Q3 Sales&#39;</span><span class="p">]</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;West&#39;</span><span class="p">,</span>    <span class="p">(</span><span class="mf">32.2</span><span class="p">,</span> <span class="mf">28.4</span><span class="p">,</span> <span class="mf">34.7</span><span class="p">))</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;East&#39;</span><span class="p">,</span>    <span class="p">(</span><span class="mf">24.3</span><span class="p">,</span> <span class="mf">30.6</span><span class="p">,</span> <span class="mf">20.2</span><span class="p">))</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Midwest&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">20.4</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">26.2</span><span class="p">))</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">LINE</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span><span class="o">.</span><span class="n">chart</span>

<span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<img alt="../_images/chart-06.png" src="../_images/chart-06.png" />
<p>I switched the categories and series data here to better suit a line chart.
You can see the line for the “West” region is <em>smoothed</em> into a curve while
the other two have their points connected with straight line segments.</p>
</section>
<section id="pie-chart">
<h2>Pie Chart<a class="headerlink" href="#pie-chart" title="永久链接至标题">¶</a></h2>
<p>A pie chart is a little special in that it only ever has a single series and
doesn’t have any axes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;West&#39;</span><span class="p">,</span> <span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">]</span>
<span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Series 1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.135</span><span class="p">,</span> <span class="mf">0.324</span><span class="p">,</span> <span class="mf">0.180</span><span class="p">,</span> <span class="mf">0.235</span><span class="p">,</span> <span class="mf">0.126</span><span class="p">))</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
    <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">PIE</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">chart_data</span>
<span class="p">)</span><span class="o">.</span><span class="n">chart</span>

<span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">BOTTOM</span>
<span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">has_data_labels</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">data_labels</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_labels</span>
<span class="n">data_labels</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0%&#39;</span>
<span class="n">data_labels</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LABEL_POSITION</span><span class="o">.</span><span class="n">OUTSIDE_END</span>
</pre></div>
</div>
<img alt="../_images/chart-07.png" src="../_images/chart-07.png" />
</section>
<section id="odds-ends">
<h2>Odds &amp; Ends<a class="headerlink" href="#odds-ends" title="永久链接至标题">¶</a></h2>
<p>This should be enough to get you started with adding charts to your
presentation with <cite>python-pptx</cite>. There are more details in the API documentation for
charts here: <a class="reference internal" href="../api/chart.html#chart-api"><span class="std std-ref">Charts</span></a></p>
<section id="about-colors">
<h3>About colors<a class="headerlink" href="#about-colors" title="永久链接至标题">¶</a></h3>
<p>By default, the colors assigned to each series in a chart are the theme
colors Accent 1 through Accent 6, in that order. If you have more than six
series, darker and lighter versions of those same colors are used. While it’s
possible to assign specific colors to data points (bar, line, pie segment,
etc.) for at least some chart types, the best strategy to start with is
changing the theme colors in your starting “template” presentation.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Working with charts</a><ul>
<li><a class="reference internal" href="#adding-a-chart">Adding a chart</a></li>
<li><a class="reference internal" href="#customizing-things-a-bit">Customizing things a bit</a></li>
<li><a class="reference internal" href="#xy-and-bubble-charts">XY and Bubble charts</a></li>
<li><a class="reference internal" href="#axes">Axes</a></li>
<li><a class="reference internal" href="#data-labels">Data Labels</a></li>
<li><a class="reference internal" href="#legend">Legend</a></li>
<li><a class="reference internal" href="#line-chart">Line Chart</a></li>
<li><a class="reference internal" href="#pie-chart">Pie Chart</a></li>
<li><a class="reference internal" href="#odds-ends">Odds &amp; Ends</a><ul>
<li><a class="reference internal" href="#about-colors">About colors</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="text.html"
                          title="上一章">文本</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="table.html"
                          title="下一章">Working with tables</a></p>
  </div><h3>Useful Links</h3>
<ul>
  <li><a href="http://github.com/scanny/python-pptx">python-pptx @ GitHub</a></li>
  <li><a href="http://pypi.python.org/pypi/python-pptx">python-pptx @ PyPI</a></li>
  <li><a href="http://github.com/scanny/python-pptx/issues">Issue Tracker</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="table.html" title="Working with tables"
             >下一页</a> |</li>
        <li class="right" >
          <a href="text.html" title="文本"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Working with charts</a></li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2012, 2013, Steve Canny.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.5.0.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>