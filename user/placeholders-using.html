
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />


    <title>使用占位符 &#8212; python-pptx 0.6.21 文档</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../../_static/searchtools.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="文本" href="text.html" />
    <link rel="prev" title="理解占位符" href="placeholders-understanding.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="text.html" title="文本"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="placeholders-understanding.html" title="理解占位符"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">使用占位符</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="working-with-placeholders">
<span id="placeholders-using"></span><h1>使用占位符<a class="headerlink" href="#working-with-placeholders" title="永久链接至标题">¶</a></h1>
<p>占位符可以让添加内容变得更容易。如果你曾经从零开始在幻灯片上添加新的文本框，并注意到它需要多少调整才能达到你想要的效果，你就会明白为什么。占位符位于合适的位置，具有合适的字体大小、段落对齐方式、项目符号样式等。基本上，你只需点击并输入一些文本，就能得到一张幻灯片。</p>
<p>占位符还可以用来在幻灯片上放置富内容对象。可以将图片、表格或图表分别插入到占位符中，从而获得占位符的位置和大小，以及某些格式属性。</p>
<section id="access-a-placeholder">
<h2>访问占位符<a class="headerlink" href="#access-a-placeholder" title="永久链接至标题">¶</a></h2>
<p>每个占位符也是形状，所以可以使用幻灯片的 <a class="reference internal" href="../api/slides.html#pptx.slide.Slide.shapes" title="pptx.slide.Slide.shapes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shapes</span></code></a> 来访问。但是，当查找特定的占位符时，<a class="reference internal" href="../api/slides.html#pptx.slide.Slide.placeholders" title="pptx.slide.Slide.placeholders"><code class="xref py py-attr docutils literal notranslate"><span class="pre">placeholders</span></code></a> 属性可以让事情变得更简单。</p>
<p>“访问已知占位符的最可靠的方法是通过它的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">idx</span></code> 的值。占位符的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">idx</span></code> 值是它继承属性的幻灯片布局占位符的整数键。因此，它在整个幻灯片的生命周期中都保持稳定，对于使用这种布局创建的任何幻灯片都是一样的。</p>
<p>通常很容易看一看幻灯片上的占位符，然后挑出你想要的:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">placeholder_format</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">0  Title 1</span>
<span class="go">1  Picture Placeholder 2</span>
<span class="go">2  Text Placeholder 3</span>
</pre></div>
</div>
<p>… 然后，手里有了已知的索引，可以直接访问它:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;pptx.parts.slide.PicturePlaceholder object at 0x10d094590&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Text Placeholder 3&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>占位符集合上的项访问类似于字典而不是列表。虽然上面使用的键是整数，但查找的是 <code class="docutils literal notranslate"><span class="pre">idx</span></code> 值，而不是序列中的位置。如果提供的值与其中占位符的 <code class="docutils literal notranslate"><span class="pre">idx</span></code> 值不匹配，则会引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code>。<code class="docutils literal notranslate"><span class="pre">idx</span></code> 值不一定是连续的。</p>
</div>
<p>通常，内置幻灯片布局（PowerPoint 提供的）占位符的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">idx</span></code> 值将在 0 到 5 之间。title 占位符将始终具有 <code class="xref py py-attr docutils literal notranslate"><span class="pre">idx</span></code> 0 (如果存在的话)，任何其他占位符将按照从上到下、从左到右的顺序跟随。在 PowerPoint 中，用户添加到幻灯片布局中的占位符将接收从 10 开始的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">idx</span></code> 值。</p>
</section>
<section id="identify-and-characterize-a-placeholder">
<h2>确定并描述占位符的特征<a class="headerlink" href="#identify-and-characterize-a-placeholder" title="永久链接至标题">¶</a></h2>
<p>占位符在某些方面的行为与其他形状不同。特别是，它的 <a class="reference internal" href="../api/shapes.html#pptx.shapes.base.BaseShape.shape_type" title="pptx.shapes.base.BaseShape.shape_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_type</span></code></a> 属性的值无条件地是 <code class="docutils literal notranslate"><span class="pre">MSO_SHAPE_TYPE.PLACEHOLDER</span></code> 不管它是什么类型的占位符或者它包含什么类型的内容:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">shape</span><span class="o">.</span><span class="n">shape_type</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">PLACEHOLDER (14)</span>
<span class="go">PLACEHOLDER (14)</span>
<span class="go">PLACEHOLDER (14)</span>
</pre></div>
</div>
<p>要想了解更多，有必要检查占位符的 <a class="reference internal" href="../api/shapes.html#pptx.shapes.base.BaseShape.placeholder_format" title="pptx.shapes.base.BaseShape.placeholder_format"><code class="xref py py-attr docutils literal notranslate"><span class="pre">placeholder_format</span></code></a> 属性内容。所有形状都有这个属性，但是在非占位符形状上访问它会引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code>。<a class="reference internal" href="../api/shapes.html#pptx.shapes.base.BaseShape.is_placeholder" title="pptx.shapes.base.BaseShape.is_placeholder"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_placeholder</span></code></a> 可以用来确定形状是否为占位符:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">is_placeholder</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">phf</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">placeholder_format</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">phf</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">phf</span><span class="o">.</span><span class="n">type</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">0, TITLE (1)</span>
<span class="go">1, PICTURE (18)</span>
<span class="go">2, BODY (2)</span>
</pre></div>
</div>
<p>占位符的另一种不同行为是，它从布局占位符继承其位置和大小。如果占位符的位置和大小被更改，这个继承将被重写。</p>
</section>
<section id="insert-content-into-a-placeholder">
<h2>将内容插入到占位符<a class="headerlink" href="#insert-content-into-a-placeholder" title="永久链接至标题">¶</a></h2>
<p>某些占位符类型具有插入内容的专用方法。在当前版本中， <cite>picture</cite>、<cite>table</cite> 和 <cite>chart</cite> 占位符都有内容插入方法。文本可以插入到 <cite>title</cite> 和 <cite>body</cite> 占位符中，就像文本插入到自动形状中一样。</p>
<section id="pictureplaceholder-insert-picture">
<h3><a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PicturePlaceholder.insert_picture" title="pptx.shapes.placeholder.PicturePlaceholder.insert_picture"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PicturePlaceholder.insert_picture()</span></code></a><a class="headerlink" href="#pictureplaceholder-insert-picture" title="永久链接至标题">¶</a></h3>
<p>picture 占位符有 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PicturePlaceholder.insert_picture" title="pptx.shapes.placeholder.PicturePlaceholder.insert_picture"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_picture()</span></code></a> 方法</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># idx key, not position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Picture Placeholder 2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">placeholder_format</span><span class="o">.</span><span class="n">type</span>
<span class="go">PICTURE (18)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">picture</span> <span class="o">=</span> <span class="n">placeholder</span><span class="o">.</span><span class="n">insert_picture</span><span class="p">(</span><span class="s1">&#39;my-image.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>对图片占位符的引用在其 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PicturePlaceholder.insert_picture" title="pptx.shapes.placeholder.PicturePlaceholder.insert_picture"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_picture()</span></code></a> 方法调用后后失效。这是因为插入图片的过程用包含图片的新 <cite>p:pic</cite> 元素替换了原始的 <cite>p:sp</cite> XML 元素。调用之后，任何使用原始占位符引用的尝试都将引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code>。新的占位符是 <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_picture()</span></code> 调用的返回值，也可以使用相同的 <cite>idx</cite> 键从占位符集合中获取。</p>
</div>
<p>以这种方式插入的图片会按比例拉伸和裁剪，以填满整个占位符。当源图像和占位符的长宽比相同时，效果最好。如果图片在外观上比占位符高，那么它的顶部和底部将被均匀地裁剪以适应。如果它更宽，它的左右两边被均匀地裁剪。可以使用占位符上的作物属性来调整裁剪，例如 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PlaceholderPicture.crop_bottom" title="pptx.shapes.placeholder.PlaceholderPicture.crop_bottom"><code class="xref py py-attr docutils literal notranslate"><span class="pre">crop_bottom</span></code></a>。</p>
</section>
<section id="tableplaceholder-insert-table">
<h3><a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.TablePlaceholder.insert_table" title="pptx.shapes.placeholder.TablePlaceholder.insert_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TablePlaceholder.insert_table()</span></code></a><a class="headerlink" href="#tableplaceholder-insert-table" title="永久链接至标题">¶</a></h3>
<p>表格占位符有 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.TablePlaceholder.insert_table" title="pptx.shapes.placeholder.TablePlaceholder.insert_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_table()</span></code></a> 方法。内置模板没有包含表占位符的布局，所以这个例子假设名为 <code class="docutils literal notranslate"><span class="pre">having-table-placeholder.pptx</span></code> 的演示文稿的第二个幻灯片布局上有 idx 10 的表格占位符:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="s1">&#39;having-table-placeholder.pptx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># idx key, not position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Table Placeholder 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">placeholder_format</span><span class="o">.</span><span class="n">type</span>
<span class="go">TABLE (12)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graphic_frame</span> <span class="o">=</span> <span class="n">placeholder</span><span class="o">.</span><span class="n">insert_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">graphic_frame</span><span class="o">.</span><span class="n">table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<p>以这种方式插入的表格具有原始占位符的位置和宽度。它的高度与行数成正比。</p>
<p>像所有的富内容插入方法一样，对表格占位符的引用在其 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.TablePlaceholder.insert_table" title="pptx.shapes.placeholder.TablePlaceholder.insert_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_table()</span></code></a> 方法调用之后就会失效。这是因为插入富内容的过程将原始的 <cite>p:sp</cite>  XML 元素替换为包含富内容对象的新元素(本例中为 <cite>p:graphicFrame</cite>)。调用之后，任何使用原始占位符引用的尝试都将引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code>。新的占位符是 <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_table()</span></code> 调用的返回值，也可以从占位符集合中使用原来的 <cite>idx</cite> 键获得，在本例中为 10。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.TablePlaceholder.insert_table" title="pptx.shapes.placeholder.TablePlaceholder.insert_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_table()</span></code></a> 方法的返回值是 <a class="reference internal" href="../api/shapes.html#pptx.shapes.graphfrm.GraphicFrame" title="pptx.shapes.graphfrm.GraphicFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicFrame</span></code></a> 对象，它拥有 <a class="reference internal" href="../api/shapes.html#pptx.shapes.graphfrm.GraphicFrame" title="pptx.shapes.graphfrm.GraphicFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicFrame</span></code></a> 对象的所有属性和方法，以及那些特定于占位符的。插入的表格包含在图形框架中，可以使用 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PlaceholderGraphicFrame.table" title="pptx.shapes.placeholder.PlaceholderGraphicFrame.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a> 来获取。</p>
</div>
</section>
<section id="chartplaceholder-insert-chart">
<h3><a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.ChartPlaceholder.insert_chart" title="pptx.shapes.placeholder.ChartPlaceholder.insert_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ChartPlaceholder.insert_chart()</span></code></a><a class="headerlink" href="#chartplaceholder-insert-chart" title="永久链接至标题">¶</a></h3>
<p>图表占位符有 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.ChartPlaceholder.insert_chart" title="pptx.shapes.placeholder.ChartPlaceholder.insert_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> 方法。内置到 <cite>python-pptx</cite> 中的演示模板没有包含图表占位符的布局，所以这个例子假设名为 <code class="docutils literal notranslate"><span class="pre">having-chart-placeholder.pptx</span></code> 的开始演示在其第二个幻灯片布局中有 idx 10 的图表占位符:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pptx.chart.data</span> <span class="kn">import</span> <span class="n">ChartData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="kn">import</span> <span class="n">XL_CHART_TYPE</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="s1">&#39;having-chart-placeholder.pptx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># idx key, not position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Chart Placeholder 9&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">placeholder</span><span class="o">.</span><span class="n">placeholder_format</span><span class="o">.</span><span class="n">type</span>
<span class="go">CHART (12)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="s1">&#39;Series 1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">graphic_frame</span> <span class="o">=</span> <span class="n">placeholder</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">PIE</span><span class="p">,</span> <span class="n">chart_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span> <span class="o">=</span> <span class="n">graphic_frame</span><span class="o">.</span><span class="n">chart</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart</span><span class="o">.</span><span class="n">chart_type</span>
<span class="go">PIE (5)</span>
</pre></div>
</div>
<p>以这种方式插入的图表具有原始占位符的位置和大小。</p>
<p>注意 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.ChartPlaceholder.insert_chart" title="pptx.shapes.placeholder.ChartPlaceholder.insert_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> 返回值是 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PlaceholderGraphicFrame" title="pptx.shapes.placeholder.PlaceholderGraphicFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">PlaceholderGraphicFrame</span></code></a> 对象，而不是图表本身。<a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PlaceholderGraphicFrame" title="pptx.shapes.placeholder.PlaceholderGraphicFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">PlaceholderGraphicFrame</span></code></a> 对象具有 <a class="reference internal" href="../api/shapes.html#pptx.shapes.graphfrm.GraphicFrame" title="pptx.shapes.graphfrm.GraphicFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicFrame</span></code></a> 对象的所有属性和方法，以及那些特定于占位符的。”插入的图表包含在图形框架中，可以使用其 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.PlaceholderGraphicFrame.chart" title="pptx.shapes.placeholder.PlaceholderGraphicFrame.chart"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chart</span></code></a> 属性获取。</p>
<p>像所有富内容插入方法一样，对图表占位符的引用在其 <a class="reference internal" href="../api/placeholders.html#pptx.shapes.placeholder.ChartPlaceholder.insert_chart" title="pptx.shapes.placeholder.ChartPlaceholder.insert_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> 方法被调用后失效。这是因为插入富内容的过程将原始的 <cite>p:sp</cite> XML 元素替换为包含富内容对象的新元素(本例中为 <cite>p:graphicFrame</cite>)。调用之后，任何使用原始占位符引用的尝试都将引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code>。新的占位符是 <code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_chart()</span></code> 调用的返回值，也可以使用原始的 <cite>idx</cite> 键从占位符集合中获取，在本例中为 10。</p>
</section>
</section>
<section id="setting-the-slide-title">
<h2>设置幻灯片标题<a class="headerlink" href="#setting-the-slide-title" title="永久链接至标题">¶</a></h2>
<p>几乎所有的幻灯片布局都有标题占位符，当布局被应用时，任何基于布局的幻灯片都会继承这个占位符。访问幻灯片标题是一种常见操作，它在形状树中有专门的属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title_placeholder</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
<span class="n">title_placeholder</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Air-speed Velocity of Unladen Swallows&#39;</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">使用占位符</a><ul>
<li><a class="reference internal" href="#access-a-placeholder">访问占位符</a></li>
<li><a class="reference internal" href="#identify-and-characterize-a-placeholder">确定并描述占位符的特征</a></li>
<li><a class="reference internal" href="#insert-content-into-a-placeholder">将内容插入到占位符</a><ul>
<li><a class="reference internal" href="#pictureplaceholder-insert-picture"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PicturePlaceholder.insert_picture()</span></code></a></li>
<li><a class="reference internal" href="#tableplaceholder-insert-table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TablePlaceholder.insert_table()</span></code></a></li>
<li><a class="reference internal" href="#chartplaceholder-insert-chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ChartPlaceholder.insert_chart()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-the-slide-title">设置幻灯片标题</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="placeholders-understanding.html"
                          title="上一章">理解占位符</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="text.html"
                          title="下一章">文本</a></p>
  </div><h3>Useful Links</h3>
<ul>
  <li><a href="http://github.com/scanny/python-pptx">python-pptx @ GitHub</a></li>
  <li><a href="http://pypi.python.org/pypi/python-pptx">python-pptx @ PyPI</a></li>
  <li><a href="http://github.com/scanny/python-pptx/issues">Issue Tracker</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="text.html" title="文本"
             >下一页</a> |</li>
        <li class="right" >
          <a href="placeholders-understanding.html" title="理解占位符"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">使用占位符</a></li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2012, 2013, Steve Canny.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.5.0.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>