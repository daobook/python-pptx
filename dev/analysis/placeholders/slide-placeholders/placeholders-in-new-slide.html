
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />


    <title>Placeholders in new slide &#8212; python-pptx 0.6.21 文档</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/rtd.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/translations.js"></script>
    <script src="../../../../../../../../_static/searchtools.js"></script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../../search.html" />
    <link rel="next" title="Layout Placeholders" href="../layout-placeholders.html" />
    <link rel="prev" title="Table placeholder" href="table-placeholder.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="../layout-placeholders.html" title="Layout Placeholders"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="table-placeholder.html" title="Table placeholder"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Analysis</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Placeholders</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Slide Placeholders</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Placeholders in new slide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="placeholders-in-new-slide">
<h1>Placeholders in new slide<a class="headerlink" href="#placeholders-in-new-slide" title="永久链接至标题">¶</a></h1>
<section id="topic-of-inquiry">
<h2>Topic of inquiry<a class="headerlink" href="#topic-of-inquiry" title="永久链接至标题">¶</a></h2>
<p>What placeholder shapes are added to a new slide when it is added to a
presentation?</p>
</section>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="永久链接至标题">¶</a></h2>
<p>Slides were created based on a variety of slide layouts so their placeholder
elements could be inspected to reveal slide construction behaviors that depend
on the slide layout chosen. A placeholder shape appeared in each slide
corresponding to each of the placeholder shapes in the slide layout, excepting
those of footer, date, and slide number type. Placeholder shapes were
<code class="docutils literal notranslate"><span class="pre">&lt;p:sp&gt;</span></code> elements for all placeholder types rather than matching the element
type of the shape they hold a place for. Each slide-side placeholder had a
<code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element that exactly matched the corresponding element in the slide
layout, with the exception that a <em>hasCustomPrompt</em> attribute, if present in
the slide layout, did not appear in the slide. Placeholders in the slide were
named and numbered differently. All placeholders in the slide layout had a
<code class="docutils literal notranslate"><span class="pre">&lt;p:txBody&gt;</span></code> element, but only certain types had one in the slide. All
placeholders were locked against grouping.</p>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="永久链接至标题">¶</a></h2>
<p>This procedure was run using PowerPoint for Mac 2011 running on an Intel-based
Mac Pro running Mountain Lion 10.8.2.</p>
<ol class="arabic simple">
<li><p>Create a new presentation based on the “White” theme.</p></li>
<li><p>Add a new slide layout and add placeholders of the following types. The
new slide layout is (automatically) named <em>Custom Layout</em>.</p>
<ul class="simple">
<li><p>Chart</p></li>
<li><p>Table</p></li>
<li><p>SmartArt Graphic</p></li>
<li><p>Media</p></li>
<li><p>Clip Art</p></li>
</ul>
</li>
<li><p>Add a new slide for each of the following layouts. Do not enter any content
into the placeholders.</p>
<ul class="simple">
<li><p>Title Slide (added automatically on File &gt; New)</p></li>
<li><p>Title and Content</p></li>
<li><p>Two Content</p></li>
<li><p>Comparison</p></li>
<li><p>Content with Caption</p></li>
<li><p>Picture with Caption</p></li>
<li><p>Vertical Title and Text</p></li>
<li><p>Custom Layout</p></li>
</ul>
</li>
<li><p>Save and unpack the presentation. This command works on OS X: <code class="docutils literal notranslate"><span class="pre">unzip</span>
<span class="pre">white.pptx</span> <span class="pre">-d</span> <span class="pre">white</span></code></p></li>
<li><p>Inspect the slide.xml files and compare placeholders with those present in
their corresponding slideLayout.xml file.</p></li>
</ol>
</section>
<section id="observations">
<h2>Observations<a class="headerlink" href="#observations" title="永久链接至标题">¶</a></h2>
<p>Typical XML for a placeholder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">sp</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">nvSpPr</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">cNvPr</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Title 1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">cNvSpPr</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spLocks</span> <span class="n">noGrp</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">p</span><span class="p">:</span><span class="n">cNvSpPr</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">nvPr</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">ph</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ctrTitle&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">p</span><span class="p">:</span><span class="n">nvPr</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">p</span><span class="p">:</span><span class="n">nvSpPr</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">spPr</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">p</span><span class="p">:</span><span class="n">txBody</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">bodyPr</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">lstStyle</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">p</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">endParaRPr</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en-US&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">p</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">p</span><span class="p">:</span><span class="n">txBody</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">p</span><span class="p">:</span><span class="n">sp</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="elements">
<h3>elements<a class="headerlink" href="#elements" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p>Placeholder shapes <strong>WERE</strong> created corresponding to layout placeholders of
the following types in the slide layout:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'title'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'body'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ctrTitle'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subTitle'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'obj'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'chart'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'tbl'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'clipArt'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dgm'</span></code> (SmartArt Graphic, perhaps abbreviation of ‘diagram’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'media'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pic'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (type attribute default is <code class="docutils literal notranslate"><span class="pre">'obj'</span></code>)</p></li>
</ul>
</li>
<li><p>Placeholder shapes <strong>WERE NOT</strong> created corresponding to layout placeholders
of these types in the slide layout:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'dt'</span></code> (date)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sldNum'</span></code> (slide number)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ftr'</span></code> (footer)</p></li>
</ul>
</li>
<li><p>The following placeholder types do not apply to slides (they apply to notes
pages and/or handouts).</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'hdr'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sldImg'</span></code></p></li>
</ul>
</li>
<li><p><strong>&lt;p:txBody&gt; element</strong>. Placeholder shapes of the following types had a
<code class="docutils literal notranslate"><span class="pre">&lt;p:txBody&gt;</span></code> element. Placeholders of all other types did not have a
<code class="docutils literal notranslate"><span class="pre">&lt;p:txBody&gt;</span></code> element.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'title'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'body'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ctrTitle'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subTitle'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'obj'</span></code> (and those without a <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute)</p></li>
</ul>
</li>
<li><p><strong>&lt;p:cNvPr&gt; element</strong>. Each placeholder shape in each slide had a
<code class="docutils literal notranslate"><span class="pre">&lt;p:cNvPr&gt;</span></code> element (it is a required element) populated with <em>id</em> and
<em>name</em> attributes.</p>
<ul>
<li><p>The value of the <em>id</em> attribute of <code class="docutils literal notranslate"><span class="pre">p:cNvPr</span></code> does not correspond to its
value in the slide layout. Shape ids were renumbered starting from 2 and
proceeding in sequence (e.g. 2, 3, 4, 5, …). Note that id=”1” belongs to
the spTree element, at <code class="docutils literal notranslate"><span class="pre">/p:sld/p:cSld/p:spTree/p:nvGrpSpPr/p:cNvPr&#64;id</span></code>.</p></li>
<li><p>The value of the <em>name</em> attribute is of the form ‘%s %d’ % (type_name,
num), where type_name is determined by the placeholder type (e.g. ‘Media
Placeholder’) and num appears to default to <code class="docutils literal notranslate"><span class="pre">id</span> <span class="pre">-</span> <span class="pre">1</span></code>. The assigned name
in each case was similar to its counterpart in the slide layout (same
<em>type_name</em>), but its number was generally different.</p></li>
</ul>
</li>
<li><p><strong>&lt;p:cNvSpPr&gt;</strong> element. Placeholder shapes of all types had the element
<code class="docutils literal notranslate"><span class="pre">&lt;a:spLocks</span> <span class="pre">noGrp=&quot;1&quot;/&gt;</span></code> specifying the placeholder could not be grouped
with any other shapes.</p></li>
<li><p><strong>&lt;p:spPr&gt;</strong> element. All placeholder shapes had an empty <code class="docutils literal notranslate"><span class="pre">&lt;p:spPr&gt;</span></code>
element.</p></li>
</ul>
</section>
<section id="attributes">
<h3>attributes<a class="headerlink" href="#attributes" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p><strong>type</strong>. The <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element was copied
without change. Where no <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute appeared (defaults to “obj”,
indicating a “content” placeholder), no <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute was added to the
<code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element.</p></li>
<li><p><strong>orient</strong>. The <code class="docutils literal notranslate"><span class="pre">orient</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element was copied
without change. Where no <code class="docutils literal notranslate"><span class="pre">orient</span></code> attribute appeared (defaults to “horz”),
no <code class="docutils literal notranslate"><span class="pre">orient</span></code> attribute was added to the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element.</p></li>
<li><p><strong>sz</strong>. The <code class="docutils literal notranslate"><span class="pre">sz</span></code> (size) attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element was copied
without change. Where no <code class="docutils literal notranslate"><span class="pre">sz</span></code> attribute appeared (defaults to “full”), no
<code class="docutils literal notranslate"><span class="pre">sz</span></code> attribute was added to the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element.</p></li>
<li><p><strong>idx</strong>. The <code class="docutils literal notranslate"><span class="pre">idx</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element was copied without
change. Where no <code class="docutils literal notranslate"><span class="pre">idx</span></code> attribute appeared (defaults to “0”, indicating the
singleton title placeholder), no <code class="docutils literal notranslate"><span class="pre">idx</span></code> attribute was added to the
<code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element.</p></li>
<li><p><strong>hasCustomPrompt</strong>. The <code class="docutils literal notranslate"><span class="pre">hasCustomPrompt</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code>
element was NOT copied from the slide layout to the slide.</p></li>
</ul>
</section>
</section>
<section id="other-observations">
<h2>Other observations<a class="headerlink" href="#other-observations" title="永久链接至标题">¶</a></h2>
<p>Placeholders created from the slide layout were always <code class="docutils literal notranslate"><span class="pre">&lt;p:sp&gt;</span></code> elements,
even when they were a placeholder for a shape of another type, e.g.
<code class="docutils literal notranslate"><span class="pre">&lt;p:graphicFrame&gt;</span></code>. When the on-screen placeholder for a table was clicked
to add a table, the <code class="docutils literal notranslate"><span class="pre">&lt;p:sp</span></code> element was replaced by a <code class="docutils literal notranslate"><span class="pre">&lt;p:graphicFrame&gt;</span></code>
element containing the table. The <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element was retained in the new
shape. Reapplying the layout to the slide caused the table to move to the
original location of the placeholder (the idx may have been used for
matching). Deleting the table caused the original placeholder to reappear in
its original position.</p>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>Placeholder shapes are added to new slides based on the placeholders present
in the slide layout specified on slide creation.</p></li>
<li><p>Placeholders for footer, slide number, and date are excluded.</p></li>
<li><p>Each new placeholder is assigned an id starting from 2 and proceeding in
increments of 1 (e.g. 2, 3, 4, …).</p></li>
<li><p>Each new placeholder is named based on its type and the id assigned.</p></li>
<li><p>Placeholders are locked against grouping.</p></li>
<li><p>Placeholders of selected types get a minimal <code class="docutils literal notranslate"><span class="pre">&lt;p:txBody&gt;</span></code> element.</p></li>
<li><p>Slide placeholders receive an exact copy of the <code class="docutils literal notranslate"><span class="pre">&lt;p:ph&gt;</span></code> element in the
corresponding slide layout placeholder, except that the optional
<code class="docutils literal notranslate"><span class="pre">hasCustomPrompt</span></code> attribute, if present, is not copied.</p></li>
</ul>
</section>
<section id="open-questions">
<h2>Open Questions<a class="headerlink" href="#open-questions" title="永久链接至标题">¶</a></h2>
<p>None.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Placeholders in new slide</a><ul>
<li><a class="reference internal" href="#topic-of-inquiry">Topic of inquiry</a></li>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#procedure">Procedure</a></li>
<li><a class="reference internal" href="#observations">Observations</a><ul>
<li><a class="reference internal" href="#elements">elements</a></li>
<li><a class="reference internal" href="#attributes">attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-observations">Other observations</a></li>
<li><a class="reference internal" href="#conclusions">Conclusions</a></li>
<li><a class="reference internal" href="#open-questions">Open Questions</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="table-placeholder.html"
                          title="上一章">Table placeholder</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="../layout-placeholders.html"
                          title="下一章">Layout Placeholders</a></p>
  </div><h3>Useful Links</h3>
<ul>
  <li><a href="http://github.com/scanny/python-pptx">python-pptx @ GitHub</a></li>
  <li><a href="http://pypi.python.org/pypi/python-pptx">python-pptx @ PyPI</a></li>
  <li><a href="http://github.com/scanny/python-pptx/issues">Issue Tracker</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="../layout-placeholders.html" title="Layout Placeholders"
             >下一页</a> |</li>
        <li class="right" >
          <a href="table-placeholder.html" title="Table placeholder"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Analysis</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Placeholders</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Slide Placeholders</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Placeholders in new slide</a></li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2012, 2013, Steve Canny.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.5.0.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>