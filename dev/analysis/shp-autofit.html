
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />


    <title>Autofit setting &#8212; python-pptx 0.6.21 文档</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/rtd.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <script src="../../../../_static/searchtools.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Group Shape" href="shp-group-shape.html" />
    <link rel="prev" title="Shape position and size" href="shp-pos-and-size.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="shp-group-shape.html" title="Group Shape"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="shp-pos-and-size.html" title="Shape position and size"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Autofit setting</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="autofit-setting">
<h1>Autofit setting<a class="headerlink" href="#autofit-setting" title="永久链接至标题">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="永久链接至标题">¶</a></h2>
<p>PowerPoint provides the <em>autofit</em> property to specify how to handle text that
is too big to fit within its shape. The three possible settings are:</p>
<ul class="simple">
<li><p>resize shape to fit text</p></li>
<li><p>resize text to fit shape</p></li>
<li><p>resize neither the shape nor the text, allowing the text to extend beyond
the bounding box</p></li>
</ul>
<p>Auto size is closely related to word wrap.</p>
<p>There are certain constraining settings for resizing the text, not sure if
those are supported in PowerPoint or not.</p>
</section>
<section id="protocol">
<h2>Protocol<a class="headerlink" href="#protocol" title="永久链接至标题">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span> <span class="o">=</span> <span class="n">MSO_AUTO_SIZE</span><span class="o">.</span><span class="n">SHAPE_TO_FIT_TEXT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span> <span class="o">=</span> <span class="n">MSO_AUTO_SIZE</span><span class="o">.</span><span class="n">TEXT_TO_FIT_SHAPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span><span class="p">)</span>
<span class="go">&#39;MSO_AUTO_SIZE.TEXT_TO_FIT_SHAPE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span> <span class="o">=</span> <span class="n">MSO_AUTO_SIZE</span><span class="o">.</span><span class="n">NONE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_frame</span><span class="o">.</span><span class="n">auto_size</span>
<span class="go">None</span>
</pre></div>
</div>
</section>
<section id="scenarios">
<h2>Scenarios<a class="headerlink" href="#scenarios" title="永久链接至标题">¶</a></h2>
<p><strong>Default new textbox.</strong>  When adding a new texbox from the PowerPoint
toolbar, the new textbox sizes itself to fit the entered text. This
corresponds to the setting MSO_AUTO_SIZE.SHAPE_TO_FIT_TEXT and <code class="docutils literal notranslate"><span class="pre">word_wrap</span>
<span class="pre">=</span> <span class="pre">None</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.NONE</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">False</span></code>. Text is free form, with
PowerPoint exhibiting no formatting behavior. Text appears just as entered
and lines are broken only where hard breaks are inserted.</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.NONE</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">True</span></code>. Text is wrapped into
a column the width of the shape, but is not constrained vertically.</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.SHAPE_TO_FIT_TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">False</span></code>. The width of
the shape expands as new text is entered. Line breaks occur only where hard
breaks are entered.  The height of the shape grows to accommodate the number
of lines of entered text.  Width and height shrink as extents of the text are
reduced by deleting text or reducing font size.</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.SHAPE_TO_FIT_TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">True</span></code>. Text is
wrapped into a column the width of the shape, with the height of the shape
growing to accommodate the resulting number of lines.</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.TEXT_TO_FIT_SHAPE</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">False</span></code>. Experiment
…</p>
<p><code class="docutils literal notranslate"><span class="pre">MSO_AUTO_SIZE.TEXT_TO_FIT_SHAPE</span></code>, <code class="docutils literal notranslate"><span class="pre">word_wrap</span> <span class="pre">=</span> <span class="pre">True</span></code>. Experiment …</p>
</section>
<section id="xml-specimens">
<h2>XML specimens<a class="headerlink" href="#xml-specimens" title="永久链接至标题">¶</a></h2>
<p>Default new textbox:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;p:sp&gt;</span>
  <span class="nt">&lt;p:nvSpPr&gt;</span>
    <span class="nt">&lt;p:cNvPr</span> <span class="na">id=</span><span class="s">&quot;4&quot;</span> <span class="na">name=</span><span class="s">&quot;Foobar 3&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:cNvSpPr</span> <span class="na">txBox=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:nvPr/&gt;</span>
  <span class="nt">&lt;/p:nvSpPr&gt;</span>
  <span class="nt">&lt;p:spPr&gt;</span>
    <span class="nt">&lt;a:xfrm&gt;</span>
      <span class="nt">&lt;a:off</span> <span class="na">x=</span><span class="s">&quot;914400&quot;</span> <span class="na">y=</span><span class="s">&quot;914400&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;a:ext</span> <span class="na">cx=</span><span class="s">&quot;914400&quot;</span> <span class="na">cy=</span><span class="s">&quot;914400&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:xfrm&gt;</span>
    <span class="nt">&lt;a:prstGeom</span> <span class="na">prst=</span><span class="s">&quot;rect&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a:avLst/&gt;</span>
    <span class="nt">&lt;/a:prstGeom&gt;</span>
    <span class="nt">&lt;a:noFill/&gt;</span>
  <span class="nt">&lt;/p:spPr&gt;</span>
  <span class="nt">&lt;p:txBody&gt;</span>
    <span class="nt">&lt;a:bodyPr</span> <span class="na">wrap=</span><span class="s">&quot;none&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a:spAutoFit/&gt;</span>
    <span class="nt">&lt;/a:bodyPr&gt;</span>
    <span class="nt">&lt;a:lstStyle/&gt;</span>
    <span class="nt">&lt;a:p/&gt;</span>
  <span class="nt">&lt;/p:txBody&gt;</span>
<span class="nt">&lt;/p:sp&gt;</span>
</pre></div>
</div>
</section>
<section id="related-schema-definitions">
<h2>Related Schema Definitions<a class="headerlink" href="#related-schema-definitions" title="永久链接至标题">¶</a></h2>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">&quot;CT_TextBody&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsd:sequence&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;bodyPr&quot;</span>   <span class="na">type=</span><span class="s">&quot;CT_TextBodyProperties&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;lstStyle&quot;</span> <span class="na">type=</span><span class="s">&quot;CT_TextListStyle&quot;</span> <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;p&quot;</span>        <span class="na">type=</span><span class="s">&quot;CT_TextParagraph&quot;</span> <span class="na">maxOccurs=</span><span class="s">&quot;unbounded&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/xsd:sequence&gt;</span>
<span class="nt">&lt;/xsd:complexType&gt;</span>

<span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">&quot;CT_TextBodyProperties&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsd:sequence&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;prstTxWarp&quot;</span> <span class="na">type=</span><span class="s">&quot;CT_PresetTextShape&quot;</span>        <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:group</span>   <span class="na">ref=</span><span class="s">&quot;EG_TextAutofit&quot;</span>                               <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;scene3d&quot;</span>    <span class="na">type=</span><span class="s">&quot;CT_Scene3D&quot;</span>                <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:group</span>   <span class="na">ref=</span><span class="s">&quot;EG_Text3D&quot;</span>                                    <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;extLst&quot;</span>     <span class="na">type=</span><span class="s">&quot;CT_OfficeArtExtensionList&quot;</span> <span class="na">minOccurs=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/xsd:sequence&gt;</span>

<span class="nt">&lt;xsd:group</span> <span class="na">name=</span><span class="s">&quot;EG_TextAutofit&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsd:choice&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;noAutofit&quot;</span>   <span class="na">type=</span><span class="s">&quot;CT_TextNoAutofit&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;normAutofit&quot;</span> <span class="na">type=</span><span class="s">&quot;CT_TextNormalAutofit&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;spAutoFit&quot;</span>   <span class="na">type=</span><span class="s">&quot;CT_TextShapeAutofit&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/xsd:choice&gt;</span>
<span class="nt">&lt;/xsd:group&gt;</span>

<span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">&quot;CT_TextNormalAutofit&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsd:attribute</span> <span class="na">name=</span><span class="s">&quot;fontScale&quot;</span> <span class="na">type=</span><span class="s">&quot;ST_TextFontScalePercentOrPercentString&quot;</span>
                 <span class="na">use=</span><span class="s">&quot;optional&quot;</span> <span class="na">default=</span><span class="s">&quot;100%&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;xsd:attribute</span> <span class="na">name=</span><span class="s">&quot;lnSpcReduction&quot;</span> <span class="na">type=</span><span class="s">&quot;ST_TextSpacingPercentOrPercentString&quot;</span>
                 <span class="na">use=</span><span class="s">&quot;optional&quot;</span> <span class="na">default=</span><span class="s">&quot;0%&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/xsd:complexType&gt;</span>

<span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">&quot;CT_TextShapeAutofit&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">&quot;CT_TextNoAutofit&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;xsd:group</span> <span class="na">name=</span><span class="s">&quot;EG_Text3D&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsd:choice&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;sp3d&quot;</span>   <span class="na">type=</span><span class="s">&quot;CT_Shape3D&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">&quot;flatTx&quot;</span> <span class="na">type=</span><span class="s">&quot;CT_FlatText&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/xsd:choice&gt;</span>
<span class="nt">&lt;/xsd:group&gt;</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Autofit setting</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#protocol">Protocol</a></li>
<li><a class="reference internal" href="#scenarios">Scenarios</a></li>
<li><a class="reference internal" href="#xml-specimens">XML specimens</a></li>
<li><a class="reference internal" href="#related-schema-definitions">Related Schema Definitions</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="shp-pos-and-size.html"
                          title="上一章">Shape position and size</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="shp-group-shape.html"
                          title="下一章">Group Shape</a></p>
  </div><h3>Useful Links</h3>
<ul>
  <li><a href="http://github.com/scanny/python-pptx">python-pptx @ GitHub</a></li>
  <li><a href="http://pypi.python.org/pypi/python-pptx">python-pptx @ PyPI</a></li>
  <li><a href="http://github.com/scanny/python-pptx/issues">Issue Tracker</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="shp-group-shape.html" title="Group Shape"
             >下一页</a> |</li>
        <li class="right" >
          <a href="shp-pos-and-size.html" title="Shape position and size"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">python-pptx 0.6.21 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Autofit setting</a></li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2012, 2013, Steve Canny.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.5.0.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>